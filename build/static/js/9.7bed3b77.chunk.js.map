{"version":3,"sources":["asset/images/recharge/checked.png","asset/images/recharge/banner.png","pages/RechargePhone/views/List.js","pages/RechargePhone/views/Nav.js","pages/RechargePhone/views/styled.js","pages/RechargePhone/views/RechargePhone.js","pages/RechargePhone/index.js"],"names":["module","exports","__webpack_require__","p","Item","_ref","id","selectId","money","integral","handleClick","itemInnerClass","classnames","active","external_React_default","a","createElement","className","onClick","List","_ref2","items","handleSelect","map","item","dicount","Number","disCount","toFixed","key","productId","salesPrice","productCostBalance","ICON_SCHEMA","2","cmcc","3","cucc","4","ctcc","type","name","handleToggleType","itemClass","src","alt","Nav","Nav_Item","productClassifyId","productClassifyName","styled","div","_templateObject","checked","CancelToken","axios","Product","loading","ProductSkeleton","length","views_List","EmptyArrayPlaceholder","SubmitBtn","pass","handleSubmit","CMCC","_default","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleChange","bind","assertThisInitialized","state","skeletonLoading","phone","operators","availableIntegral","history","location","loadUserInfo","loadOperatorById","loadProductsByType","loadUserInfoSource","cancel","loadOperatorSource","loadProductsSource","source","api","getUserInfo","cancelToken","token","data","status","setState","balance","getProducts","getRechargePhoneProductsByType","pswd","weui","params","chargeAddr","tranPwd","rechargePhone","alert","msg","util","confirmRetry","_this2","retryTransPswd","hide","_this3","updateBtnStatus","_this4","reset","_this5","e","_this6","target","value","_this7","paymentConfirm","title","amount","useable","callback","inputElem","doSubmit","_this$state","Helmet","defaultTitle","banner","views_Nav","onChange","placeholder","autoComplete","RechargePhone_Product","RechargePhone_SubmitBtn","Backhome","Component","d","__webpack_exports__","RechargePhone_default"],"mappings":"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","file":"static/js/9.7bed3b77.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAYAAABzwahEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTNGN0U4RTM1QzQwMTFFOUFERkZBNkQ1NkUxQzk4RDkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTNGN0U4RTI1QzQwMTFFOUFERkZBNkQ1NkUxQzk4RDkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Mjk4RDI0MjE1QzA5MTFFOUIzOUFEMTA2MTBCNTlGQUYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Mjk4RDI0MjI1QzA5MTFFOUIzOUFEMTA2MTBCNTlGQUYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5aBO+DAAABSElEQVR42uTbSQ7DIAwF0Pqrx+ipe2FXkZpF1ckJnuAjJSsQfkIMASK3u14Ik4IRvb3AiGaDv/RpMKJZ4B9HbzCiV4f/nKfBiF4VblqRgRG9GvzQ2huM6FXgp76ywIieHT70PQ1G9Kxwl50TMKJng7vukYERPQs8ZDcUjOju8NB9bzCiu8JTTjjAiO4GTz3LAiO6C7zk1BKM6Gp46fk0GNFV8BY3EcCIzoa3unMCRnQWvAItz6cMXoUubfG26Eh4B3T6xYD26Ai4GgKUarQ3XA8EKJVoT7ieyCNVaC+4DuSVCrQHXB3KSDZ6FK6OZSUTPQLXgC4iWeizcM952ooX7xhQiLbiJSIGFKP/4SUqBjRAW1s+/WJA5tpbs2JAI/S3OkNiuDZDp9WNhuiUBEb0NnCCEP3W4ixo2Qc3pp9LxTKqLwne00OAAQA6hVn4c+aVigAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/banner.c86d7444.png\";","import React from 'react'\r\nimport classnames from 'classnames'\r\n\r\nfunction Item({id, selectId, money, integral, handleClick}) {\r\n  const itemInnerClass = classnames('item__inner', {'active': id === selectId})\r\n  return (\r\n    <div className=\"item\">\r\n      <div className={itemInnerClass} onClick={handleClick}>\r\n        <div className=\"item__money\">{money}元</div>\r\n        <div className=\"item__integral\">{integral}积分</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction List({selectId, items, handleSelect}) {\r\n  return (\r\n    <div className=\"items\">\r\n      {items.map(item => {\r\n        const dicount = (Number(item.disCount) / 10).toFixed(2)\r\n        return (\r\n          <Item\r\n            key={item.productId}\r\n            id={item.productId}\r\n            selectId={selectId}\r\n            money={item.salesPrice}\r\n            integral={item.productCostBalance * dicount}\r\n            handleClick={() => handleSelect(item.productId, item.productCostBalance * dicount)}\r\n          />\r\n        )\r\n      })}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default List","import React from 'react'\r\nimport classnames from 'classnames'\r\n\r\nimport cmcc from '@/asset/images/recharge/cmcc.png'\r\nimport cucc from '@/asset/images/recharge/cucc.png'\r\nimport ctcc from '@/asset/images/recharge/ctcc.png'\r\n\r\nconst ICON_SCHEMA = {\r\n  '2': cmcc,\r\n  '3': cucc,\r\n  '4': ctcc\r\n}\r\n\r\nfunction Item({id, type, name, handleToggleType}) {\r\n  const itemClass = classnames({'active': id === type})\r\n  return (\r\n    <li \r\n      className={itemClass} \r\n      onClick={() => handleToggleType(id)}\r\n    >\r\n      <img className=\"icon\" src={ICON_SCHEMA[id]} alt=\"\"/>\r\n      {name}\r\n    </li>\r\n  )\r\n}\r\n\r\nfunction Nav({items, type, handleToggleType}) {\r\n  return (\r\n    <ul className=\"nav\">\r\n      {items.map(item => (\r\n        <Item\r\n          key={item.productClassifyId} \r\n          type={type}\r\n          id={item.productClassifyId}\r\n          name={item.productClassifyName}\r\n          handleToggleType={handleToggleType}\r\n        />\r\n      ))}\r\n    </ul>\r\n  )\r\n}\r\n\r\nexport default Nav","import styled from 'styled-components'\r\n\r\nimport checked from '@/asset/images/recharge/checked.png'\r\n\r\nexport default styled.div`\r\n  header{\r\n    margin-bottom: 15px;\r\n    .nav-box{\r\n      position: relative;\r\n      margin: -70px 15px 0 15px;\r\n    }\r\n    .nav{\r\n      display: flex;\r\n      background: #fff;\r\n      border-radius: 3px;\r\n      box-shadow: 0 1px 3px rgba(26,26,26,.1);\r\n      li{\r\n        flex: 1;\r\n        position: relative;\r\n        text-align: center;\r\n        padding: 15px 0;\r\n        font-size: 15px;\r\n        &.active{\r\n          color: #1c92ff;\r\n          &:after{\r\n            content: '';\r\n            position: absolute;\r\n            left: 50%;\r\n            bottom: 3px;\r\n            transform: translate(-50%);\r\n            height: 2px;\r\n            width: 60px;\r\n            background: #1c92ff;\r\n          }\r\n        }\r\n        .icon{\r\n          display: block;\r\n          width: 35px;\r\n          margin: 0 auto 5px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .main{\r\n    background: #fff;\r\n    .input-box{\r\n      padding: 12px;\r\n      border: 1px solid #eaeaea;\r\n    }\r\n    .items{\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      margin: 0 10px;\r\n      .item{\r\n        width: 33.33%;\r\n        padding: 5px;\r\n        &__inner{\r\n          position: relative;\r\n          text-align: center;\r\n          padding: 10px;\r\n          border-radius: 2px;\r\n          border: 1px solid #eaeaea;\r\n          &.active{\r\n            color: #1c92ff;\r\n            border-color: #1c92ff;\r\n            &:after{\r\n              content: '';\r\n              position: absolute;\r\n              bottom: 0;\r\n              right: 0;\r\n              background: url(${checked}) center top no-repeat;\r\n              background-size: 100%;\r\n              width: 20px;\r\n              height: 20px;\r\n            }\r\n          }\r\n        }\r\n        &__money{\r\n          font-size: 16px;\r\n          font-weight: bold;\r\n        }\r\n        &__integral{\r\n          font-size: 12px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n`\r\n","import React, { Component } from 'react'\r\nimport axios from 'axios'\r\nimport weui from 'weui.js'\r\nimport {Helmet} from \"react-helmet\"\r\n\r\nimport api, {getProducts, rechargePhone} from '@/api'\r\nimport util from '@/util'\r\nimport ProductSkeleton from '@/common/ProductSkeleton'\r\nimport EmptyArrayPlaceholder from '@/common/EmptyArrayPlaceholder'\r\nimport Backhome from '@/common/Backhome'\r\nimport List from './List'\r\nimport Nav from './Nav'\r\nimport Page from './styled'\r\n\r\nimport banner from '@/asset/images/recharge/banner.png'\r\n\r\nconst CancelToken = axios.CancelToken\r\n\r\nconst Product = ({loading, selectId, handleSelect, items}) => {\r\n  if(loading) {\r\n    return <ProductSkeleton />\r\n  }\r\n  if(items.length) {\r\n    return <List items={items} selectId={selectId} handleSelect={handleSelect} />\r\n  }\r\n  return <EmptyArrayPlaceholder />\r\n}\r\n\r\nconst SubmitBtn = ({pass, handleSubmit}) => {\r\n  if(pass) {\r\n    return <button className=\"btn btn-secondary\" onClick={handleSubmit}>立即充值</button>\r\n  }\r\n  return <button className=\"btn btn-secondary disable\" onClick={handleSubmit}>立即充值</button>\r\n}\r\n\r\nconst CMCC = '2'\r\nconst CUCC = '3'\r\nconst CTCC = '4'\r\n\r\nexport default class extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.handleChange = this.handleChange.bind(this)\r\n    this.handleSubmit = this.handleSubmit.bind(this)\r\n    this.handleSelect = this.handleSelect.bind(this)\r\n    this.handleToggleType = this.handleToggleType.bind(this)\r\n\r\n    this.state = {\r\n      pass: false,\r\n\r\n      items: [],\r\n      skeletonLoading: false,\r\n\r\n      phone: '',\r\n      selectId: '',\r\n\r\n      type: CMCC,\r\n      operators: [],\r\n\r\n      integral: 0,\r\n      availableIntegral: 0\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const {id} = this.props.history.location.state\r\n    this.loadUserInfo()\r\n    this.loadOperatorById(id)\r\n    this.loadProductsByType(this.state.type)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.loadUserInfoSource && this.loadUserInfoSource.cancel('Operation canceled by the user.')\r\n    this.loadOperatorSource && this.loadOperatorSource.cancel('Operation canceled by the user.')\r\n    this.loadProductsSource && this.loadProductsSource.cancel('Operation canceled by the user.')\r\n  }\r\n\r\n  async loadUserInfo() {\r\n    this.loadUserInfoSource = CancelToken.source()\r\n    try {\r\n      const {data} = await api.getUserInfo(null, {cancelToken: this.loadUserInfoSource.token})\r\n      if(data.status === 200) {\r\n        this.setState({availableIntegral: Number(data.data[0].balance)})\r\n      }\r\n    }finally {\r\n    }\r\n  }\r\n\r\n  async loadOperatorById(id) {\r\n    this.loadOperatorSource = CancelToken.source()\r\n    try {\r\n      const {data} = await getProducts(id, {cancelToken: this.loadOperatorSource.token})\r\n      if(data.status === 200) {\r\n        this.setState({operators: data.data})\r\n      }\r\n    }finally {\r\n    }\r\n  }\r\n\r\n  async loadProductsByType(type) {\r\n    this.setState({skeletonLoading: true})\r\n    this.loadProductsSource = CancelToken.source()\r\n    try {\r\n      const {data} = await api.getRechargePhoneProductsByType(type, {cancelToken: this.loadProductsSource.token})\r\n      if(data.status === 200) {\r\n        this.setState({items: data.data})\r\n      }\r\n    }finally {\r\n      this.setState({skeletonLoading: false})\r\n    }\r\n  }\r\n\r\n  async doSubmit(pswd) {\r\n    const loading = weui.loading('处理中')\r\n    const params = {\r\n      chargeAddr: this.state.phone,\r\n      productId: this.state.selectId,\r\n      tranPwd: pswd\r\n    }\r\n    try {\r\n      const {data} = await rechargePhone(params)\r\n      if(data.status === 200) {\r\n        weui.alert(data.msg)\r\n      }else if(data.status === 1017) {\r\n        util.confirmRetry('密码错误', () => {\r\n          this.retryTransPswd()\r\n        })\r\n      }else {\r\n        weui.alert(data.msg)\r\n      }\r\n    }finally {\r\n      loading.hide()\r\n    }\r\n  }\r\n\r\n  retryTransPswd() {\r\n    this.handleSubmit()\r\n  }\r\n\r\n  updateBtnStatus() {\r\n    if(this.state.phone && this.state.selectId && (this.state.integral <= this.state.availableIntegral)) {\r\n      this.setState({pass: true})\r\n    }else {\r\n      this.setState({pass: false})\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    this.setState({selectId: ''}, () => {\r\n      this.updateBtnStatus()\r\n    })\r\n  }\r\n\r\n  handleToggleType(type) {\r\n    if(type === this.state.type) {return}\r\n    this.reset()\r\n    this.setState({type}, () => {\r\n      this.loadProductsByType(type)\r\n    })\r\n  }\r\n\r\n  handleSelect(selectId, integral) {\r\n    this.setState({selectId, integral}, () => {\r\n      this.updateBtnStatus()\r\n    })\r\n  }\r\n\r\n  handleChange(e) {\r\n    this.setState({phone: e.target.value}, () => {\r\n      this.updateBtnStatus()\r\n    })\r\n  }\r\n\r\n  handleSubmit() {\r\n    if(!this.state.phone) {\r\n      weui.alert('请输入手机号')\r\n      return\r\n    }\r\n    if(!this.state.selectId) {\r\n      weui.alert('请选择产品')\r\n      return\r\n    }\r\n    if(this.state.integral > this.state.availableIntegral) {\r\n      weui.alert('积分不足')\r\n      return\r\n    }\r\n\r\n    util.paymentConfirm({\r\n      title: '充值',\r\n      amount: this.state.integral,\r\n      useable: this.state.availableIntegral,\r\n      callback: (e, inputElem) => {\r\n        if(!inputElem.value) {return false}\r\n        this.doSubmit(inputElem.value)\r\n      }\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const {selectId, type, items, operators, skeletonLoading, pass} = this.state\r\n\r\n    return (\r\n      <Page>\r\n        <Helmet defaultTitle=\"沃银企服\" title=\"话费充值\"/>\r\n        \r\n        <header>\r\n          <img src={banner} alt=\"\"/>\r\n          <div className=\"nav-box\">\r\n            <Nav type={type} items={operators} handleToggleType={this.handleToggleType} />\r\n          </div>\r\n        </header>\r\n\r\n        <main className=\"main\">\r\n\r\n          <div className=\"u_p_xxx\">\r\n            <div className=\"input-box\">\r\n              <input\r\n                className=\"input input-primary\" \r\n                type=\"number\" \r\n                value={this.state.phone}\r\n                onChange={this.handleChange} \r\n                placeholder=\"请输入手机号\" \r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <h2 className=\"u_mx_xxx u_mb_x\">请选择面值</h2>\r\n          <Product loading={skeletonLoading} selectId={selectId} items={items} handleSelect={this.handleSelect} />\r\n\r\n          <div className=\"u_p_xxx\">\r\n            <SubmitBtn pass={pass} handleSubmit={this.handleSubmit}/>\r\n          </div>\r\n        </main>\r\n\r\n        <Backhome />\r\n      </Page>\r\n    )\r\n  }\r\n}","import view from './views/RechargePhone'\r\n\r\nexport {view}"],"sourceRoot":""}